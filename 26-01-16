Urban Camera Network Celibation
1. 사용된 주요 카메라 투영 모델들

- 핀홀 카메라 모델(Pinhole Model) : 카메라를 이상적인 투영 장치로 간주한 모델,
투영 방정식은 3D 점의 좌표를 비례 투영하여 이미지 평면상의 2D 점으로 변환
이 모델은 렌즈 왜곡이 없기 때문에 직선의 영상은 그대로 직선으로 투영
핀홀 모델은 카메라의 기본 투영 특성을 나타내며, 다른 복잡한 모델들의 기반이 됨
단 실제 광각 렌즈에서는 왜곡이 무시되지 않으므로, 추가적인 왜곡 모델이 필요

- Brown-Conrady 왜곡 모델 (다중 항 왜곡 모델) :
일반적인 카메라의 방사형(radial) 및 비대칭(tangential) 왜곡을 표현하는 고전적인 모델
방사형 왜곡은 이미지 중심에서의 반경에 따라 증가하거나 감소하는 왜곡을 의미
이 논문의 실제 환경 실험에서도 ETRI 제공 카메라 모델로 사용
여러 개의 왜곡 계수를 사용하여 유연하게 왜곡을 보정하지만, 파라미터 개수가 많아지면 과적합 위험이 있다.

- Field-of-View (FOV) 왜곡 모델 : 광각 어안렌즈의 왜곡을 한 개의 파라미터로 표현하는 모델,
단 하나의 파라미터로 광각 왜곡을 표현하므로 간결하며, 넓은 시야각 카메라 교정에 효과적
다양한 카메라에 대해 비교적 안정적인 왜곡 보정을 제공
다만 단일 계수로 표현되므로 복잡한 왜곡을 세밀하게 보정하는 데는 한계가 있을 수 있다.

> 각 모델은 카메라 보정 단계에서 후보로 사용, 각 카메라에 대해 최적의 모델을 교차 검증을 통해 선택
카메라 왜곡 보정의 정확도를 높이고 잘못된 모델 선택으로 인한 오차를 줄이는 역할을 함
> 

2. 제안된 보정 방법론 및 전체 프레임워크 구성

- 위성 영상 활용 및 초기값 설정 :
보정 대상이 되는 도로상의 마커(노면 표시)들의 3차원 위치를 위성 지도를 통해 추정
위성 이미지 상에서 도로 마커들의 위도/경도 좌표를 수집하고, 이를 통해 마커의 절대 위치(예: UTM 좌표)를 얻는다.
높이(Z)는 처음에는 지형에 따라 추정, 평탄한 지면으로 가정하면 모든 마커의 Z를 0으로 두거나, 지형 모델을 이용해 초기 높이를 설정
위성 영상으로부터 카메라의 대략적인 위치와 방향 및 도로 마커들의 위치를 얻음으로써, 보정 알고리즘의 초기 추정을 제공
이는 카메라 간 시야 중첩이 적은 경우에도 보정을 시작할 수 있도록 하는 핵심 아이디어

- 지형 모델 통합(Terrain Model) :
도시 환경은 평지가 아닌 언덕, 경사로, 계단 등이 존재하므로, 마커의 높이(Z)가 일정하지 않을 수 있다.
이를 대비해 여러 가지 지형 모델을 실험에 포함
지형 모델은 마커들의 공간적 분포에 대한 가정을 말하며, 논문에서는 4가지 지형 모델을 사용
    - 평지 모델 – 모든 마커의 높이가 일정한 평탄 지면으로 가정 (모델 기호: X̄ȲZ̄)
    - 경사 지면 모델 – 일정한 경사각 θ를 가진 기울어진 평면 위에 마커들이 놓인 것으로 가정 (X̄ȲZθ)
    - 계단식 모델 – 마커 그룹마다 서로 다른 높이를 허용하여 불연속적인 계단 지형을 표현 (X̄ȲZ)
    - 그 밖에 복합 지형 모델 등이 있습니다.
    
    실제 가상 환경 실험에서는 세 가지 지형 경우(평지, 언덕 경사, 계단형 지면)를 설정하여, 각 지형에 맞게 어느 모델이 적절한지 평가
    가상 환경 1은 높이 0의 평지로, 평지 가정 모델(X̄ȲZ̄)이 잘 맞았고,
    환경 2는 경사진 언덕으로 경사 모델도 큰 무리 없이 표현
    그러나 환경 3은 계단 지형이라 단순 경사 모델로는 포착 못하는 복잡함이 있어,
    훈련 및 검증 RMSE가 90 이상 크게 나오는 등 오차가 증가
    이처럼 하나의 지형 모델로 모두 표현할 수 없을 경우를 대비해, 본 논문은 여러 모델을 두고 최적의 조합을 찾도록 되어 있다.
    지형 모델은 도로 마커들의 높이 분포에 대한 제약을 제공하여, 최적화 중 과도한 자유도를 억제하고 보정 안정성을 높이는 역할을 함
    
- 다중 카메라 모델 및 최적 조합 탐색 :
앞서 소개한 여러 카메라 투영/왜곡 모델과 여러 지형 모델의 조합을 모두 실험하여,
어떤 조합이 가장 정확한 보정 결과를 내는지 찾는다.
카메라 모델 × 지형 모델의 모든 조합에 대해 최적화 과정을 수행
논문에서 총 6개의 카메라 모델과 4개의 지형 모델을 사용, 최대 24가지 조합을 고려
다만 일부 조합은 실제로 동일한 카메라 모델이면 지형 모델 차이가 미치는 영향이 작을 수 있어,
- 카메라 모델을 우선적인 요인으로 간주한다고 언급
실제로 “카메라 모델이 동일하면 지형 모델 예측이 달라도 해당 조합을 중요하게 본다”고 하여, 카메라 모델 선택이 1차적인 목표임을 나타냄
이는 마커 초기값의 노이즈가 낮아서 지형 모델의 영향이 상대적으로 적기 때문이며, 기본 투영 모델 자체의 맞음 여부가 더 중요하다는 의미

- 비선형 최적화 (번들조정) :
각 조합별로, 도로 마커들의 3D 위치(특히 높이값) 와 카메라의 내부/외부 파라미터를
동시에 조정하는 최적화 단계가 수행됨
이 최적화의 목적함수는 카메라로 투영된 마커 점들의 영상 좌표 오차를 최소화하는 것입니다.
위성 지도에서 얻은 마커의 세계 좌표를 카메라 모델로 투영하여 영상상의 추정 좌표를 계산하고,
실제 이미지에서 사람이 측정한 실제 픽셀 좌표와의 차이를 최소화하도록 파라미터를 조정합니다.
여러 카메라를 동시에 보정할 경우 번들 조정(Bundle Adjustment) 형태로
모든 카메라와 3D 마커 좌표를 함께 최적화하게 됩니다.
최적화 결과로 각 조합마다 학습(훈련) 데이터에 대한 오차와 검증 데이터에 대한 오차가 산출됩니다.
또한 가상 환경의 경우 최적화된 3D 점들과 카메라 파라미터를 그라운드트루스와 비교하여,
오차가 얼마나 줄었는지 분석하였습니다.

- 교차 검증 및 모델 선택(Model Selection) :
과적합을 방지하기 위해 입력 데이터(도로 마커)를 훈련용과 검증용으로 분할(cross-validation)
각 모델 조합에 대해 훈련 데이터 RMSE와 검증 데이터 RMSE를 모두 구한 뒤,
이를 토대로 모델 선정 지표(model selection index)를 계산함
훈련 오차가 낮으면서 검증 오차와 차이가 적은 모델일수록 좋은 값이 나오도록 설계
단순히 훈련 RMSE가 낮다고 최적 모델로 선정되는 것이 아니라, 훈련과 검증 성능의 균형이 고려됨
복잡한 모델이 훈련 데이터에 과적합되면 검증 RMSE가 높아지는 경향을 패널티로 반영하기 위함
논문에서는 이러한 모델 선택을 위한 계량적 지표를 새롭게 도입하였으며,
교차 검증과 모델 선택 절차를 거쳐
가장 낮은 모델 선택 점수(S)를 갖는 카메라 모델+지형 모델 조합이 최종 채택
실환경 테스트에서도 이 지표 상위에 오른 모델들로 왜곡을 보정한 결과를 비교 평가하여,
시각적으로 왜곡이 가장 잘 보정되는 모델을 확인함

- 결과 및 활용 :
최종 선택된 보정 파라미터들을 적용하여 카메라 영상의 왜곡을 보정하고,
카메라의 자세(위치 및 방향)를 3차원 지도로 시각화
제안된 방법론은 위성영상 + 단일 이미지라는 최소 입력으로, 다양한 모델 조합을 탐색하고
교차 검증을 통해 최적의 보정 해법을 찾아내는 포괄적인 자동 보정 시스템이라고 할 수 있다.
